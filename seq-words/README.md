# seq-words

Extracting sequentially appearing words from data generated by [soap-seq](../soap-seq).

## Usage

`Usage: seq-words --min-words <MIN_WORDS> --input <INPUT_FILE> --output <OUTPUT_FILE> --subject <SUBJECT_FILE>`

- `--min-words/-m`: the minimum number of words in each sentence.
- `--input/-i`: the path to the input CSV file generated by [soap-seq](../soap-seq).
- `--output/-o`: the path for the output CSV file.
- `--subject/-s`: the subject mapping CSV file.
    - This file can be generated by running the SQL query `SELECT * FROM dbo.ufn_GetSubjectMapping()` on the aicsapi database and then exporting it as a CSV.

## Algorithm

To improve performance and minimize memory consumption, the following algorithm is used:

First, it processes data doctor by doctor, so each time it only needs to handle data from one doctor.

For each doctor, we first walk through the SOAP notes and find all the sentences that contain only the minimum number of words, with no non-words (e.g., punctuation, white spaces) at the beginning or end. Then we get a set of all these sentences that appear more than once. When enumerating each sub-sentence from a note, once we find that the sentence between the last minimum amount of words does not exist more than twice, we stop adding more words to the sentence, as it won't appear more than once.

After we have collected all the sub-sentences and the encounter IDs they occur in, we remove the sentences that are part of another sentence with the same frequency, as they appear only as part of another sentence.

## Further Possible Optimizations

- Processing doctors in parallel.
